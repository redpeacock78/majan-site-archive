<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
<META name="GENERATOR" content="IBM HomePage Builder 2001 V5.0.3 for Windows">
<META http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<META http-equiv="Content-Style-Type" content="text/css">
<TITLE>トップ率、有意差検定</TITLE>
</HEAD>
<BODY bgcolor="#ceffce" alink="#ffff00" vlink="#990000">
<BLOCKQUOTE>
<BLOCKQUOTE>
<TABLE border="1" bgcolor="#000000">
  <TBODY>
    <TR>
      <TD><FONT size="+2" color="#ffff00"><B><FONT size="-2"><FONT face="Lucida Sans" size="+2" color="#ffff00"><I><FONT size="+3"><FONT color="#ffff00" size="-1"><FONT size="+1">　Ｐersonal</FONT><FONT size="+2"> <FONT color="#ffff00" size="-1">analyze　</FONT></FONT></FONT></FONT></I></FONT></FONT></B><FONT face="Lucida Sans" color="#cc00cc" size="-1"><FONT size="+3"><FONT color="#cc00cc" size="-1"><FONT size="+1" color="#ffff00">諸分析</FONT></FONT></FONT></FONT></FONT>　.</TD>
    </TR>
  </TBODY>
</TABLE>
</BLOCKQUOTE>
</BLOCKQUOTE>
<BLOCKQUOTE>
<BLOCKQUOTE>
<TABLE border="1" bgcolor="#cccc00">
  <TBODY>
    <TR>
      <TD bgcolor="#8080ff"><FONT size="-1" color="#ffffff"><FONT size="+1"><BR>
      　　　　（４）トップ率に関する有意差検定<BR>
      <BR>
      </FONT></FONT></TD>
    </TR>
    <TR>
      <TD bgcolor="#ffffd7">
      <BLOCKQUOTE><BR>
      　半荘 Ｎ 回やって、Ｘ回トップを取った人のトップ率
      ｔ は、ｔ ＝ Ｘ／Ｎ　（標本値）で定義するものとします。この得られた標本値から考えて、自分の実力としての雀力Ｔ（トップ率の母集団値）がいかほどのものか知りたい場合には、以下の計算をすればよい。<BR>
      <BR>
      帰無仮説：Ｔ＝ａ（←証明したい数値、例えば、0.4とか0.5とかを入れる）<BR>
      対立仮説：Ｔ＞ａ（右片側検定）<BR>
      <BR>
      　　　　　　　　　　｜ｔ−ａ｜<BR>
      統計量Ｕ＝−−−−−−−−−−−−−＊平方根（Ｎ）<BR>
      　　　　　　　　　 平方根（ａ＊(１−ａ））<BR>
      　　　　　　　<BR>
      　この統計量Ｕと標準正規分布の右片側α％点と比較し、Ｕ＞ｕ（α）
      であれば、有意水準αで帰無仮説を棄却します。<BR>
      <BR>
      　有意水準１％　ｕ（α）＝ｕ（０．０１）＝２．３２６<BR>
      　有意水準５％　ｕ（α）＝ｕ（０．０５）＝１．６４５　です。<BR>
      <BR>
      　なお、適応の目安として、ＮＴ＞５とします。また、統計量自身がすでに近似計算してありますので、小数第３位以下はあまり信憑性がありません。また、Ｔ＜ａの可能性も考慮して両側検定でやる場合は、右片側（α／２）％点と比較して、<BR>
      　有意水準１％　ｕ（α／２）＝ｕ（０．００５）＝２．５７６<BR>
      　有意水準５％　ｕ（α／２）＝ｕ（０．０２５）＝１．９６０<BR>
      で行います。<BR>
      <BR>
      ★★数値例です★★<BR>
      （問題）半荘２０回やって、トップ１５回取りました。この人の雀力
      Ｔ は、Ｔ＞５０％　と言ってよいか、有意水準１％で検定せよ。<BR>
      <BR>
      標本比率として、ｔ＝１５／２０＝０．７５<BR>
      帰無仮説：Ｔ＝０．５　　（ａ＝０．５のケース）<BR>
      対立仮説：Ｔ＞０．５　　（右片側検定）<BR>
      <BR>
      　　　　　　　　　（０．７５−０．５）<BR>
      統計量Ｕ＝−−−−−−−−−−−−−−−−＊平方根（２０）<BR>
      　　　　　　　　平方根（０．５＊(１−０．５））<BR>
      <BR>
      　　　　　＝２．２３６＜２．３２６＝ｕ（０．０１）<BR>
      <BR>
      　となり、きわどく、帰無仮説Ｔ＝０．５を棄却できません。<BR>
      （何の結論も得られない状態になる）<BR>
      （有意水準５％だと１．６４５より大きいので棄却できます）<BR>
      （Ｔ＝０．４９という帰無仮説を立てると、有意水準１％で棄却できます。）<BR>
      　なお、このトップ率Ｔは、半荘６回とか８回とかの短期決戦におけるトップ率Ｒであるとしても、全く同じように解けます。<BR>
      <BR>
      　今までの８連勝の例にこだわってもいいのですが、本当は、Ｆ分布を使わなければだめだとか、勝率１００％なんで、信頼区間もままならず、ちょっと例としてはよくないかなーと思って変えました。<BR>
      <BR>
      　また、結論の解釈ですが、「有意水準５％で、Ｔ＞５０％と言ってよい」と言えるということは、この人の最近の２０回の試合ぶりの勝率７割５分というデータから、将来を予測すると、次の半荘でトップをとる確率は、５０％以上といっても構いません。<BR>
      　ただし、この判断を誤る可能性は、５％存在します。すなわち同じ様な判断を１００回繰り返すとそのうちの９５回は判断を間違えないですが、残り５回は間違うと考えられます。<BR>
      <BR>
      <B>上昇曲線論の決着（？）</B><BR>
      <BR>
      #3370のＦ分布で計算してみました。<BR>
      　ｎ＝８、ｋ＝８、ｐ＝８／８＝１．０<BR>
      　ｎ１＝２（８−８＋１）＝２<BR>
      　ｎ２＝２*８＝１６<BR>
      　<BR>
      　Ｆ(n1,n2,α/2)＝Ｆ（２，１６，０．０１）＝６．２２６<BR>
      　　　　　　　　　　　　　　　　^^^^^^^^<BR>
      　　　　　　　　　　　　　　　　 　↑<BR>
      　上限は１００％だから下限だけで、１％とっていいのかな？０．００５でやるべきか？<BR>
      よって、<BR>
      信頼下限＝１６÷（２*６．２２６＋１６）＝０．５６２<BR>
      　　∴　０．５６２＜Ｒ＜１．０　（９９％信頼区間）<BR>
      このＲで８半荘中、４勝以上する確率を計算します。<BR>
      <BR>
      　以下の方法論は、自分は完全には同意したわけではないですが、大勢はこの方法が正しいということなので、自らの不利を顧みず計算結果を提示します。(^_^；<BR>
      <BR>
      　Ｒの値が変化した場合の様子をみるために、文字のまま計算します。<BR>
      <BR>
      ８勝:8Ｃ8*Ｒ^8 ＝　　Ｒ^8<BR>
      ７勝:8Ｃ7*Ｒ^7*(１−Ｒ)　＝　８Ｒ^7*(１−Ｒ)<BR>
      ６勝:8Ｃ6*Ｒ^6*(１−Ｒ)^2＝２８Ｒ^6*(１−Ｒ)^2<BR>
      ５勝:8Ｃ5*Ｒ^5*(１−Ｒ)^3＝５６Ｒ^5*(１−Ｒ)^3<BR>
      ４勝:8Ｃ4*Ｒ^4*(１−Ｒ)^4＝７０Ｒ^4*(１−Ｒ)^4<BR>
      <BR>
      　全部合計して、<BR>
      Σ＝Ｒ^4*（７０*(１−Ｒ)^4＋５６Ｒ*(１−Ｒ)^3＋２８Ｒ^2*(１−Ｒ)^2
      ＋８Ｒ^3*(１−Ｒ)＋Ｒ^4）＝Ｇ(Ｒ)　<BR>
      <BR>
      このΣをＧ(Ｒ)とおいて、Ｒに関する関数と考えます。このＲの８次関数について、９９％信頼区間内での最大値と最小値をだす。<BR>
      <BR>
      まず微分して、<BR>
      　Ｇ'(Ｒ)＝２８０*Ｒ^3(１−Ｒ)^4　と意外と(?)と簡単な形になりました。<BR>
      <BR>
      増減表を書いてみます。<BR>
      <BR>
      　　　　Ｒ　 　　 −無限大....０....１....＋無限大<BR>
      　　　　Ｇ'(Ｒ)　 　　　　 − ０ ＋ ０ ＋<BR>
      　　　　Ｇ(Ｒ)　　 　　　 下降　上昇　上昇<BR>
      <BR>
      ０＜Ｒ＜１　の範囲では、Ｇ'(Ｒ)＞０とＧ(Ｒ)は単調増加を示します。<BR>
      <BR>
      個別の値を計算してみると、<BR>
      　Ｇ(０)　　　　＝０　（以下、括弧内の数字は小数第５位を四捨五入した）<BR>
      　Ｇ(０．１)　　＝０．０１　　　（０．００５０）<BR>
      　Ｇ(０．２)　　＝０．０６　　　（０．０５６３）<BR>
      　Ｇ(０．３)　　＝０．２０　　　（０．１９４１）<BR>
      　Ｇ(０．４)　　＝０．４１　　　（０．４０５９）<BR>
      　Ｇ(０．５)　　＝０．６４　　　（０．６３６７）<BR>
      　Ｇ(０．５６２)＝０．７６　　　（０．７６２７）<BR>
      　Ｇ(０．６)　　＝０．８２　　　（０．８２６３）<BR>
      　Ｇ(０．７)　　＝０．９４　　　（０．９４２０）<BR>
      　Ｇ(０．８)　　＝０．９９　　　（０．９８９６）<BR>
      　Ｇ(０．９)　　＝１．００　　　（０．９９９６）<BR>
      　Ｇ(１)　　　　＝１<BR>
      <BR>
      とここまで計算しました。<BR>
      ０．５６２＜Ｒ＜１．０　（９９％信頼区間）だから、単純に　０．７６＜Ｇ(Ｒ)＜１　でいいのかな。ようわからん。。。。<BR>
      <BR>
      <B>８連続トップ</B><BR>
      <BR>
      &gt;８連勝＝８連続トップという意味ですね？。<BR>
      &gt;記録に残っているゲーム、即ちチャット麻雀(406半荘戦）月例会(約200半荘戦)<BR>
      &gt;及び某麻雀団体における約5000一荘戦において一度もありません。<BR>
      <BR>
      　別人２８号さんほどの高打率のトップ率の方でも、一度遭遇するかどうかのレベルの発生頻度ということですね。そこで、単純に、トップ率（Ｒ）と連続トップ数（５から８まで）を変化<BR>
      させて計算させてみました。<BR>
      　例えば、Ｒ＝0.35の８連続では、（0.35)^8=0.00023　というぐあいに単純にＲの８乗を計算しています。<BR>
      <BR>
      　Ｒ | 0.25 | 0.30 | 0.35 | 0.40 |<BR>
      −−−−−−−−−−−−−−−−−−−−−−−−<BR>
      ８連続| 0.00002 | 0.00007 | 0.00023 | 0.00066
      |<BR>
      ７連続| 0.00006 | 0.00022 | 0.00064 | 0.00164
      |<BR>
      ６連続| 0.00024 | 0.00073 | 0.00184 | 0.00410
      |<BR>
      ５連続| 0.00098 | 0.00243 | 0.00525 | 0.01024
      |<BR>
      ４連続| 0.00391 | 0.00810 | 0.01501 | 0.02560
      |<BR>
      <BR>
      Ｒ＝０．３５の場合だと、５連続トップの確率は約２００分の１、<BR>
      ８連続トップの確率は、約５０００分の１、と出ました。<BR>
      Ｒ＝０．２５の平均的プレーヤーの場合、８連続トップの確率は、約５００００分の１です。うーん、やっぱり大変むずかしい。(@_@)<BR>
      <BR>
      <B>最終結論が見えたか</B><BR>
      <BR>
      少し確率の本を読んで勉強し直しました。<BR>
      <BR>
      　母集団の特性値(今の場合は、半荘ごとのトップ率Ｒ)が判明しても、確率変数Ｘ(試行の結果を表す変数のこと、今の場合はトップ率)の分布があるわけで、トップ率Ｒの結果が必ず帰って来るわけではなく、二項分布であれば、その平均Ｅ(Ｘ)＝Ｎ*Ｒ、分散Ｖ(Ｘ)＝平方根(Ｎ*Ｒ*(１-Ｒ))、の分布を示すことがわかりました。(当たり前か・・・）<BR>
      　<BR>
      　したがって、例えば、トップ率Ｒ＝０.３０の人の場合、半荘１００回やれば、単純に３０回トップを取ると考えてはだめで、<BR>
      　Ｅ(Ｘ)＝Ｎ*Ｒ＝100×0.30＝30<BR>
      　Ｖ(Ｘ)＝平方根(Ｎ*Ｒ*(１-Ｒ))＝SQRT(100×0.30×0.70)＝4.583<BR>
      の二項分布Ｂ(100,0.30)に従うと考える必要があります。つまり最大の山は３０回の付近にありますが、その近辺も十分ウロウロするということです。<BR>
      <BR>
      ちょっと具体例で計算してみました。<BR>
      (1)トップ数が３１回以上４０回以下となる確率は？<BR>
      　Ｐ(31≦Ｘ≦40)＝φ((40-30+0.5)/4.583)-φ((31-30-0.5)/4.583)<BR>
      　　　　　　　　　　＝φ(2.29)-φ(0.11)<BR>
      　　　　　　　　　　＝0.4890-0.0438＝0.4452　　∴約４５％<BR>
      　<BR>
      (2)トップ数が２５回以下になる確率は？<BR>
      　Ｐ(0≦Ｘ≦25)＝φ((25-30+0.5)/4.583)-φ(0-30-0.5/4.583)
      ＝-φ(0.98)+φ(6.65)<BR>
      　　 ＝-0.3365+0.5＝0.1635 　∴約１６％<BR>
      <BR>
      　なおこの計算では２項分布の正規分布近似として、ラプラスの定理を使っています。さらに離散分布から連続分布への補正も行っています。<BR>
      <BR>
      ラプラスの定理<BR>
      Ｐ(ａ≦Ｓ≦ｂ)＝φ((ｂ-Ｅ(Ｘ)+0.5)/Ｖ(Ｘ))-φ((ａ-Ｅ(Ｘ)-0.5)/Ｖ(Ｘ))<BR>
      φは標準正規分布を表しており、φ(∞)＝0.5
      です。<BR>
      ｂｙ 多摩（ターニア）97/7/3<BR>
      <BR>
      </BLOCKQUOTE>
      </TD>
    </TR>
  </TBODY>
</TABLE>
</BLOCKQUOTE>
</BLOCKQUOTE>
<P align="center"><A href="pers3.html">以前へ</A>　　<A href="pers5.html">以降へ</A>　　<A href="PERSONAL.html">目次へ</A></P>
</BODY>
</HTML>
